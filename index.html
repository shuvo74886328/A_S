<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="A & S Business Management System" />
  <meta name="keywords" content="Business, Inventory, Sales, Profit, Management" />
  <meta name="author" content="A & S Business" />
  <title>A & S Business</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #e6ecf0;
      color: #333;
      padding: 1rem;
    }
    header {
      background: linear-gradient(to right, #0d1b2a, #1b263b);
      color: white;
      padding: 1.5rem;
      text-align: center;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
      border-radius: 10px 10px 0 0;
    }
    .ad-space {
      background-color: #415a77;
      padding: 1rem;
      border-radius: 0 0 10px 10px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
      text-align: center;
    }
    .ad-box {
      max-width: 320px; /* Matches ad width */
      margin: 0.5rem auto; /* Center the ad */
      background: #fff;
      border: 1px solid #ccc;
      border-radius: 5px;
      overflow: hidden; /* Ensure ad fits within box */
    }
    nav {
      background-color: #1b263b;
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      border-radius: 10px;
      margin-top: 1rem;
      box-shadow: 0 0 10px rgba(0,0,0,0.15);
    }
    nav button {
      padding: 1rem;
      background: none;
      border: none;
      font-weight: bold;
      color: #f1f1f1;
      cursor: pointer;
      transition: 0.3s;
      flex: 1 1 100px;
      max-width: 150px;
    }
    nav button.active, nav button:hover {
      border-bottom: 3px solid #fca311;
      color: #fca311;
    }
    .container {
      max-width: 1000px;
      margin: 2rem auto;
      padding: 1rem 1.5rem;
      background: white;
      border-radius: 10px;
      box-shadow: 0 0 15px rgba(0,0,0,0.1);
    }
    section {
      display: none;
      padding: 1rem 0 0 0;
    }
    section.active { display: block; }
    h2 {
      color: #0d1b2a;
      border-bottom: 2px solid #eee;
      padding-bottom: 0.5rem;
      margin-bottom: 1rem;
    }
    input, button, select {
      width: 100%;
      padding: 0.8rem;
      margin: 0.5rem 0;
      border-radius: 5px;
      border: 1px solid #ccc;
      font-size: 1rem;
    }
    button {
      background-color: #1b263b;
      color: white;
      border: none;
      font-weight: bold;
      transition: 0.3s;
    }
    button:hover { background-color: #415a77; }
    ul { list-style-type: none; padding-left: 0; max-height: 250px; overflow-y: auto; }
    li { padding: 0.5rem 0; border-bottom: 1px solid #eee; font-size: 1rem; }
    img.product-img {
      width: 100px;
      height: auto;
      margin-top: 10px;
      border-radius: 5px;
    }
    /* Login page styles */
    #login-page {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      background: #0d1b2a;
    }
    #login-box {
      background: white;
      padding: 2rem;
      border-radius: 10px;
      width: 300px;
      box-shadow: 0 0 15px rgba(0,0,0,0.3);
    }
    #main-content { display: none; }
    /* Search input styling for customer sales */
    #searchInput {
      margin-bottom: 1rem;
      font-size: 1rem;
      padding: 0.7rem;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
    /* Customer Ranking box */
    #customerRankingBox {
      margin-top: 2rem;
      padding: 1rem;
      background: #f9f9f9;
      border-radius: 10px;
      box-shadow: inset 0 0 10px #ddd;
      max-height: 300px;
      overflow-y: auto;
    }
    #customerRankingBox h3 {
      margin-bottom: 1rem;
      color: #0d1b2a;
      border-bottom: 1px solid #ccc;
      padding-bottom: 0.3rem;
    }
    #customerRankingList li {
      padding: 0.3rem 0;
      border-bottom: 1px solid #eee;
      font-weight: 600;
    }
    /* Best Selling Product box styling */
    #bestSellingBox {
      margin-top: 2rem;
      padding: 1rem;
      background: #f0f8ff;
      border-radius: 10px;
      box-shadow: inset 0 0 12px #a2c4c9;
      max-height: 300px;
      overflow-y: auto;
    }
    #bestSellingBox h3 {
      margin-bottom: 1rem;
      color: #0d1b2a;
      border-bottom: 1px solid #ccc;
      padding-bottom: 0.3rem;
    }
    #bestSellingList li {
      padding: 0.3rem 0;
      border-bottom: 1px solid #eee;
      font-weight: 600;
      display: flex;
      justify-content: space-between;
    }
  </style>
</head>
<body>
  <div id="login-page">
    <div id="login-box">
      <h2 style="text-align:center; color:#0d1b2a;">Login</h2>
      <input type="text" id="username" placeholder="Username" />
      <input type="password" id="password" placeholder="Password" />
      <button onclick="login()">Login</button>
      <p id="login-error" style="color: red; text-align:center; margin-top: 0.5rem; display: none;">Invalid credentials</p>
    </div>
  </div>
  <div id="main-content">
    <header>
      <h1>A & S Business</h1>
      <div class="ad-space">
        <!-- Adsterra Ad 1 -->
        <div class="ad-box">
          <script type="text/javascript">
            atOptions = {
              'key' : 'af176843cafe05d3bf1f193ee4fdd3af',
              'format' : 'iframe',
              'height' : 50,
              'width' : 320,
              'params' : {}
            };
          </script>
          <script type="text/javascript" src="//www.highperformanceformat.com/af176843cafe05d3bf1f193ee4fdd3af/invoke.js"></script>
        </div>
        <!-- Adsterra Ad 2 -->
        <div class="ad-box">
          <script type='text/javascript' src='//pl26820144.profitableratecpm.com/ab/e0/c9/abe0c98c29d0116eb1996e51e9ed675d.js'></script>
        </div>
      </div>
    </header>
    <nav>
      <button onclick="showSection('inventory')" id="btn-inventory">Product Inventory</button>
      <button onclick="showSection('today')" id="btn-today">Today's Sales</button>
      <button onclick="showSection('monthly')" id="btn-monthly">Monthly Sales</button>
      <button onclick="showSection('yearly')" id="btn-yearly">Yearly Report</button>
      <button onclick="showSection('profit')" id="btn-profit">Profit Tracker</button>
      <button onclick="showSection('customer')" id="btn-customer">Customer Sales</button>
      <button onclick="showSection('bestSelling')" id="btn-bestSelling">Best Selling Products</button>
    </nav>
    <main class="container">
      <section id="inventory">
        <h2>Product Inventory</h2>
        <input type="text" id="invProductName" placeholder="Product Name" />
        <input type="number" id="invBuyPrice" placeholder="Buy Price (in currency)" />
        <input type="number" id="invQty" placeholder="Quantity" />
        <input type="file" id="invImg" accept="image/*" />
        <button onclick="addToInventory()">Add to Inventory</button>
        <ul id="inventoryList"></ul>
      </section>
      <section id="today">
        <h2>Today's Sales</h2>
        <input type="text" id="saleProductName" placeholder="Product Name" />
        <input type="number" id="saleQty" placeholder="Quantity Sold" />
        <input type="number" id="salePrice" placeholder="Selling Price per Unit (in currency)" />
        <button onclick="processTodaySale()">Submit Sale</button>
        <p id="todaySales"></p>
        <p id="todayProfit"></p>
      </section>
      <section id="monthly">
        <h2>Monthly Sales</h2>
        <p id="monthlySalesReport">Total Monthly Sales: ৳0</p>
      </section>
      <section id="yearly">
        <h2>Yearly Report</h2>
        <p id="yearlySalesReport">Total Yearly Sales: ৳0</p>
      </section>
      <section id="profit">
        <h2>Profit Tracker</h2>
        <p id="profitToday">Today's Profit: ৳0</p>
        <p id="profitMonthly">Monthly Profit: ৳0</p>
        <p id="profitYearly">Yearly Profit: ৳0</p>
      </section>
      <section id="customer">
        <h2>Customer Sales</h2>
        <input type="text" id="custName" placeholder="Customer name" />
        <input type="text" id="custProduct" placeholder="Product name" />
        <input type="number" id="custPrice" placeholder="Selling price (in currency)" />
        <button onclick="saveCustomerSale()">Save Record</button>
        <input type="text" id="searchInput" placeholder="Search by Customer or Product" onkeyup="searchSales()" />
        <ul id="customerList"></ul>
        <div id="customerRankingBox">
          <h3>Customer Ranking (Top Buyers)</h3>
          <ul id="customerRankingList">
            <li>No data yet.</li>
          </ul>
        </div>
      </section>
      <section id="bestSelling">
        <h2>Best Selling Products</h2>
        <div id="bestSellingBox">
          <h3>Top Products by Quantity Sold</h3>
          <ul id="bestSellingList">
            <li>No sales data yet.</li>
          </ul>
        </div>
      </section>
    </main>
  </div>

  <script>
    let inventory = {};
    let monthlySales = 0;
    let yearlySales = 0;
    let totalProfit = 0;
    let todayProfit = 0;
    let monthlyProfit = 0;
    let yearlyProfit = 0;
    let customerSales = [];
    let productSales = {};

    function login() {
      const user = document.getElementById("username").value;
      const pass = document.getElementById("password").value;
      if (user === "Admin" && pass === "12345678") {
        document.getElementById("login-page").style.display = "none";
        document.getElementById("main-content").style.display = "block";
        showSection('inventory');
      } else {
        document.getElementById("login-error").style.display = "block";
      }
    }

    function showSection(id) {
      const sections = document.querySelectorAll("main section");
      const buttons = document.querySelectorAll("nav button");
      sections.forEach(s => s.classList.remove("active"));
      buttons.forEach(b => b.classList.remove("active"));
      document.getElementById(id).classList.add("active");
      document.getElementById("btn-" + id).classList.add("active");
      if (id === 'bestSelling') {
        updateBestSellingProducts();
      }
    }

    function addToInventory() {
      const name = document.getElementById("invProductName").value.trim();
      const buy = parseFloat(document.getElementById("invBuyPrice").value);
      const qty = parseInt(document.getElementById("invQty").value);
      const imgInput = document.getElementById("invImg");
      let imgURL = '';
      if (!name || isNaN(buy) || isNaN(qty) || qty <= 0) {
        alert("সঠিক তথ্য দিন");
        return;
      }
      if (imgInput.files.length > 0) {
        const reader = new FileReader();
        reader.onload = function (e) {
          imgURL = e.target.result;
          updateInventory(name, buy, qty, imgURL);
        };
        reader.readAsDataURL(imgInput.files[0]);
      } else {
        updateInventory(name, buy, qty, imgURL);
      }
    }

    function updateInventory(name, buy, qty, imgURL) {
      if (!inventory[name]) {
        inventory[name] = { qty: 0, buyPrice: buy, img: imgURL };
      }
      inventory[name].qty += qty;
      if (imgURL) inventory[name].img = imgURL;
      renderInventory();
      clearInventoryInputs();
    }

    function clearInventoryInputs() {
      document.getElementById("invProductName").value = "";
      document.getElementById("invBuyPrice").value = "";
      document.getElementById("invQty").value = "";
      document.getElementById("invImg").value = "";
    }

    function renderInventory() {
      const ul = document.getElementById("inventoryList");
      ul.innerHTML = "";
      for (let key in inventory) {
        let imgTag = inventory[key].img ? `<img class="product-img" src="${inventory[key].img}" alt="${key}">` : "";
        ul.innerHTML += `<li><strong>${key}</strong> - Qty: ${inventory[key].qty}, Buy Price: ৳${inventory[key].buyPrice.toFixed(2)} ${imgTag}</li>`;
      }
    }

    function processTodaySale() {
      const name = document.getElementById("saleProductName").value.trim();
      const qty = parseInt(document.getElementById("saleQty").value);
      const price = parseFloat(document.getElementById("salePrice").value);

      if (!name || isNaN(qty) || qty <= 0 || isNaN(price) || price <= 0) {
        alert("সঠিক তথ্য দিন");
        return;
      }
      if (!inventory[name] || inventory[name].qty < qty) {
        alert("Inventory ত পর্যাপ্ত পরিমাণ নেই");
        return;
      }

      inventory[name].qty -= qty;
      renderInventory();

      const saleAmount = price * qty;
      monthlySales += saleAmount;
      yearlySales += saleAmount;

      const profit = (price - inventory[name].buyPrice) * qty;
      todayProfit += profit;
      monthlyProfit += profit;
      yearlyProfit += profit;

      document.getElementById("todaySales").textContent = `Today's Sale Amount: ৳${saleAmount.toFixed(2)}`;
      document.getElementById("todayProfit").textContent = `Today's Profit: ৳${profit.toFixed(2)}`;

      updateSalesReports();
      updateProfitReports();

      if (!productSales[name]) productSales[name] = 0;
      productSales[name] += qty;

      if (document.getElementById('customer').classList.contains('active')) {
        updateCustomerRanking();
      }

      clearTodaySalesInputs();
    }

    function clearTodaySalesInputs() {
      document.getElementById("saleProductName").value = "";
      document.getElementById("saleQty").value = "";
      document.getElementById("salePrice").value = "";
    }

    function updateSalesReports() {
      document.getElementById("monthlySalesReport").textContent = `Total Monthly Sales: ৳${monthlySales.toFixed(2)}`;
      document.getElementById("yearlySalesReport").textContent = `Total Yearly Sales: ৳${yearlySales.toFixed(2)}`;
    }

    function updateProfitReports() {
      document.getElementById("profitToday").textContent = `Today's Profit: ৳${todayProfit.toFixed(2)}`;
      document.getElementById("profitMonthly").textContent = `Monthly Profit: ৳${monthlyProfit.toFixed(2)}`;
      document.getElementById("profitYearly").textContent = `Yearly Profit: ৳${yearlyProfit.toFixed(2)}`;
    }

    function saveCustomerSale() {
      const custName = document.getElementById("custName").value.trim();
      const custProduct = document.getElementById("custProduct").value.trim();
      const custPrice = parseFloat(document.getElementById("custPrice").value);

      if (!custName || !custProduct || isNaN(custPrice) || custPrice <= 0) {
        alert("সঠিক তথ্য দিন");
        return;
      }

      customerSales.push({ customer: custName, product: custProduct, price: custPrice });
      renderCustomerSales();
      updateCustomerRanking();

      document.getElementById("custName").value = "";
      document.getElementById("custProduct").value = "";
      document.getElementById("custPrice").value = "";
    }

    function renderCustomerSales() {
      const ul = document.getElementById("customerList");
      ul.innerHTML = "";
      customerSales.forEach((sale, idx) => {
        ul.innerHTML += `<li><strong>${sale.customer}</strong> bought <em>${sale.product}</em> for ৳${sale.price.toFixed(2)}</li>`;
      });
    }

    function searchSales() {
      const query = document.getElementById("searchInput").value.toLowerCase();
      const filtered = customerSales.filter(sale => 
        sale.customer.toLowerCase().includes(query) || sale.product.toLowerCase().includes(query)
      );
      const ul = document.getElementById("customerList");
      ul.innerHTML = "";
      if (filtered.length === 0) {
        ul.innerHTML = "<li>No results found.</li>";
        return;
      }
      filtered.forEach(sale => {
        ul.innerHTML += `<li><strong>${sale.customer}</strong> bought <em>${sale.product}</em> for ৳${sale.price.toFixed(2)}</li>`;
      });
    }

    function updateCustomerRanking() {
      if (customerSales.length === 0) {
        document.getElementById("customerRankingList").innerHTML = "<li>No data yet.</li>";
        return;
      }
      const countMap = {};
      customerSales.forEach(sale => {
        if (!countMap[sale.customer]) countMap[sale.customer] = 0;
        countMap[sale.customer]++;
      });
      const ranked = Object.entries(countMap).sort((a, b) => b[1] - a[1]);
      const ul = document.getElementById("customerRankingList");
      ul.innerHTML = "";
      ranked.forEach(([name, count]) => {
        ul.innerHTML += `<li>${name} - Purchases: ${count}</li>`;
      });
    }

    function updateBestSellingProducts() {
      const ul = document.getElementById("bestSellingList");
      if (Object.keys(productSales).length === 0) {
        ul.innerHTML = "<li>No sales data yet.</li>";
        return;
      }
      const sortedProducts = Object.entries(productSales).sort((a,b) => b[1] - a[1]);
      ul.innerHTML = "";
      sortedProducts.forEach(([product, qty]) => {
        ul.innerHTML += `<li><span>${product}</span><span>Qty Sold: ${qty}</span></li>`;
      });
    }
  </script>
</body>
</html>